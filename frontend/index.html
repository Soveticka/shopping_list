<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping List</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <div class="header-title">
                        <svg class="trash-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18l-2 13H5L3 6z"/>
                            <path d="M8 6V4c0-1 1-2 2-2h4c0 0 1 1 1 2v2"/>
                        </svg>
                        <h1>Shopping List</h1>
                    </div>
                    <div class="stats" id="stats">0 needed ‚Ä¢ 0 purchased ‚Ä¢ 0 total</div>
                </div>
                <div class="header-right">
                    <div class="connection-status" id="connectionStatus" title="Auto-update status">
                        <div class="status-indicator online" id="statusIndicator"></div>
                        <span class="status-text">Online</span>
                    </div>
                    
                    <!-- Shopping List Dropdown -->
                    <div class="shopping-list-dropdown-container">
                        <button class="shopping-list-toggle" id="shoppingListToggle" title="Shopping Lists">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 6h18l-2 13H5L3 6z"/>
                                <path d="M8 6V4c0-1 1-2 2-2h4c0 0 1 1 1 2v2"/>
                            </svg>
                            <span class="current-list-indicator" id="currentListIndicator">Select List</span>
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: 4px;">
                                <polyline points="6,9 12,15 18,9"/>
                            </svg>
                        </button>
                        <div class="shopping-list-dropdown" id="shoppingListDropdown" style="display: none;">
                            <div class="dropdown-header">
                                <h3>Shopping Lists</h3>
                                <button class="new-list-btn-header" onclick="showNewListModal()" title="Create new list">+</button>
                            </div>
                            
                            <!-- My Lists -->
                            <div class="dropdown-category">
                                <div class="dropdown-category-header">
                                    <span class="dropdown-category-title">My Lists</span>
                                    <span class="dropdown-category-count" id="headerMyListsCount">0</span>
                                </div>
                                <div class="dropdown-list-items" id="headerMyListsContainer">
                                    <!-- Owned lists will be rendered here -->
                                </div>
                            </div>
                            
                            <!-- Shared with me -->
                            <div class="dropdown-category">
                                <div class="dropdown-category-header">
                                    <span class="dropdown-category-title">Shared with me</span>
                                    <span class="dropdown-category-count" id="headerSharedListsCount">0</span>
                                </div>
                                <div class="dropdown-list-items" id="headerSharedListsContainer">
                                    <!-- Shared lists will be rendered here -->
                                </div>
                            </div>
                            
                            <!-- Current list actions -->
                            <div class="dropdown-actions" id="headerCurrentListActions" style="display: none;">
                                <div class="dropdown-actions-header">
                                    <span class="dropdown-current-list-name" id="headerCurrentListName">Current List</span>
                                    <div class="dropdown-current-list-badges" id="headerCurrentListBadges"></div>
                                </div>
                                <div class="dropdown-action-buttons">
                                    <button class="dropdown-action-btn" onclick="showEditListModal()" title="Rename list" id="headerRenameListBtn">‚úèÔ∏è</button>
                                    <button class="dropdown-action-btn" onclick="toggleDefaultList()" title="Set as default" id="headerDefaultListBtn">‚≠ê</button>
                                    <button class="dropdown-action-btn" onclick="showSharingModal()" title="Manage sharing" id="headerSharingBtn">üë•</button>
                                    <button class="dropdown-action-btn delete" onclick="confirmDeleteList()" title="Delete list" id="headerDeleteListBtn">üóëÔ∏è</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">‚òÄÔ∏è</button>
                    <div class="notification-bell-container">
                        <button class="notification-bell" id="notificationBell" title="Notifications">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
                                <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
                            </svg>
                            <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                        </button>
                        <div class="notification-dropdown" id="notificationDropdown" style="display: none;">
                            <div class="notification-header">
                                <h3>Notifications</h3>
                                <button class="clear-all-btn" id="clearAllBtn" title="Mark all as read">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="20,6 9,17 4,12"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="notification-list" id="headerNotificationsList">
                                <!-- Notifications will be rendered here -->
                            </div>
                            <div class="no-notifications" id="noNotifications" style="display: none;">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
                                </svg>
                                <p>No new notifications</p>
                            </div>
                        </div>
                    </div>
                    <button class="theme-toggle" onclick="logout()" title="Logout">üë§</button>
                </div>
            </header>

            <div class="search-container">
                <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                </svg>
                <input type="text" class="search-input" id="searchInput" placeholder="Search items..." autocomplete="off">
            </div>

            <div class="filters">
                <button class="filter-btn active" data-filter="all">All Items</button>
                <button class="filter-btn" data-filter="needed">Needed</button>
                <button class="filter-btn" data-filter="purchased">Purchased</button>
            </div>

            <div class="bulk-actions">
                <button class="bulk-btn" onclick="bulkSelect()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 11l3 3L22 4"/>
                        <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>
                    </svg>
                    Select
                </button>
                <button class="bulk-btn" onclick="markPurchased()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 6L9 17l-5-5"/>
                    </svg>
                    Mark Purchased
                </button>
                <button class="bulk-btn" onclick="markNeeded()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="8" y1="12" x2="16" y2="12"/>
                    </svg>
                    Mark Needed
                </button>
                <button class="bulk-btn" onclick="deleteSelected()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="3,6 5,6 21,6"/>
                        <path d="m19,6v14a2,2 0 0,1-2,2H7a2,2 0 0,1-2-2V6m3,0V4a2,2 0 0,1,2-2h4a2,2 0 0,1,2,2v2"/>
                    </svg>
                    Delete
                </button>
                <div class="share-dropdown">
                    <button class="share-btn" onclick="toggleShareDropdown()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8"/>
                            <polyline points="16,6 12,2 8,6"/>
                            <line x1="12" y1="2" x2="12" y2="15"/>
                        </svg>
                        Share
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: 4px;">
                            <polyline points="6,9 12,15 18,9"/>
                        </svg>
                    </button>
                    <div class="share-menu" id="shareDropdown" style="display: none;">
                        <button class="share-option" onclick="shareList()">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                            </svg>
                            Share Link
                        </button>
                        <button class="share-option" onclick="showInviteModal()">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                                <circle cx="9" cy="7" r="4"/>
                                <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                            </svg>
                            Invite User
                        </button>
                    </div>
                </div>
            </div>

            <div class="categories" id="categoriesContainer">
                <!-- Categories will be rendered here -->
            </div>
        </main>

        <aside class="sidebar">
            <h2 class="sidebar-title">Add item</h2>

            <form class="add-form" onsubmit="addItem(event)">
                <div class="form-group">
                    <label class="form-label" for="itemName">Item Name</label>
                    <div class="autocomplete-container">
                        <input type="text" class="form-input" id="itemName" placeholder="What do you need?" required autocomplete="off">
                        <div class="autocomplete-suggestions" id="autocompleteSuggestions"></div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group form-group-small">
                        <label class="form-label" for="itemQuantity">Qty</label>
                        <div class="quantity-input-group-compact">
                            <button type="button" class="qty-btn-compact" onclick="adjustQuantity(-1)">‚àí</button>
                            <input type="number" class="form-input quantity-input-compact" id="itemQuantity" value="1" min="1" required>
                            <button type="button" class="qty-btn-compact" onclick="adjustQuantity(1)">+</button>
                        </div>
                    </div>
                    <div class="form-group form-group-large">
                        <label class="form-label" for="itemCategory">Category</label>
                        <select class="form-input form-select-compact" id="itemCategory" required>
                            <option value="produce">Produce</option>
                            <option value="dairy">Dairy</option>
                            <option value="meat">Meat & Seafood</option>
                            <option value="pantry">Pantry</option>
                            <option value="frozen">Frozen</option>
                            <option value="bakery">Bakery</option>
                            <option value="beverages">Beverages</option>
                            <option value="snacks">Snacks</option>
                            <option value="household">Household</option>
                            <option value="health">Health & Beauty</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group form-group-half">
                        <label class="form-label" for="itemPriority">Priority</label>
                        <select class="form-input form-select-compact" id="itemPriority" required>
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                    <div class="form-group form-group-half">
                        <label class="form-label" for="itemNotes">Notes</label>
                        <input type="text" class="form-input form-input-compact" id="itemNotes" placeholder="Optional...">
                    </div>
                </div>

                <button type="submit" class="add-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                    Add to List
                </button>
            </form>

            <div class="memory-section">
                <button class="memory-toggle" onclick="toggleMemorySection()" type="button">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 11H5a2 2 0 00-2 2v7a2 2 0 002 2h11a2 2 0 002-2v-7a2 2 0 00-2-2h-4"/>
                        <polyline points="9,11 12,14 15,11"/>
                        <line x1="12" y1="14" x2="12" y2="3"/>
                    </svg>
                    Shopping Memory
                    <svg class="memory-chevron" id="memoryChevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6,9 12,15 18,9"/>
                    </svg>
                </button>
                <div class="memory-content" id="memoryContent" style="display: none;">
                    <div class="memory-stats" id="memoryStats">0 items remembered ‚Ä¢ 0 total uses</div>
                    <div class="frequent-items" id="frequentItems"></div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Authentication Modal -->
    <div class="auth-overlay" id="authOverlay" style="display: none;">
        <div class="auth-modal">
            <div class="auth-header">
                <h2 class="auth-title" id="authTitle">Welcome Back</h2>
                <p class="auth-subtitle" id="authSubtitle">Sign in to access your shopping lists</p>
            </div>
            
            <div class="auth-error" id="authError"></div>
            <div class="auth-success" id="authSuccess"></div>

            <!-- Login Form -->
            <form class="auth-form" id="loginForm">
                <div class="form-group">
                    <input type="text" class="form-input" id="loginEmail" placeholder="Email or username" required>
                </div>
                <div class="form-group">
                    <input type="password" class="form-input" id="loginPassword" placeholder="Password" required>
                </div>
                <button type="submit" class="auth-submit" id="loginSubmit">Sign In</button>
            </form>

            <!-- Register Form -->
            <form class="auth-form" id="registerForm" style="display: none;">
                <div class="form-group">
                    <input type="text" class="form-input" id="registerUsername" placeholder="Username" required>
                </div>
                <div class="form-group">
                    <input type="email" class="form-input" id="registerEmail" placeholder="Email address" required>
                </div>
                <div class="form-group">
                    <input type="password" class="form-input" id="registerPassword" placeholder="Password" required>
                </div>
                <button type="submit" class="auth-submit" id="registerSubmit">Create Account</button>
            </form>

            <div class="auth-switch">
                <span id="loginSwitch">Don't have an account? <button type="button" onclick="switchToRegister()">Sign up</button></span>
                <span id="registerSwitch" style="display: none;">Already have an account? <button type="button" onclick="switchToLogin()">Sign in</button></span>
            </div>
        </div>
    </div>

    <!-- Shopping List Management Modals -->
    <div class="auth-overlay" id="listModalOverlay" style="display: none;">
        <div class="auth-modal">
            <div class="auth-header">
                <h2 class="auth-title" id="listModalTitle">Create New Shopping List</h2>
            </div>
            <form id="listForm">
                <div class="form-group">
                    <input type="text" class="form-input" id="listNameInput" placeholder="Enter list name..." required maxlength="255">
                </div>
                <div class="auth-actions">
                    <button type="button" class="auth-btn secondary" onclick="hideListModal()">Cancel</button>
                    <button type="submit" class="auth-btn primary" id="listFormSubmit">Create List</button>
                </div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>